{"layout/empty":"<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>{{ head.title }}</title>\r\n    {{{ head.meta_tags }}}\r\n    {{{ head.config }}}\r\n\r\n    <link href=\"{{ head.favicon }}\" rel=\"shortcut icon\">\r\n    {{#block \"head\"}}{{/block}}\r\n</head>\r\n<body>\r\n    {{#block \"page\"}}{{/block}}\r\n</body>\r\n</html>\r\n","pages/checkout":"{{#partial \"head\"}}\r\n\r\n{{{ checkout.checkout_head }}}\r\n<!-- Global site tag (gtag.js) - Google Analytics -->\r\n       \r\n       <script rel=\"preconnect\" async src=\"https://www.googletagmanager.com/gtag/js?id=UA-200229297-1\"></script>\r\n       <script>\r\n         window['GoogleAnalyticsObject'] = 'ga';\r\n         window['ga'] = window['ga'] || function() {\r\n           (window['ga'].q = window['ga'].q || []).push(arguments)\r\n         };\r\n       </script>\r\n\r\n       <script>\r\n\r\n       var guestCustID= 'KP_' + Math.floor(Math.random() * 100000);\r\n       var custID= '';\r\n       {{#if customer}}\r\n          \r\n          custID = {{customer.id}};\r\n       {{else}}          \r\n           \r\n           custID = guestCustID;\r\n           \r\n       {{/if}}\r\n       window.dataLayer = window.dataLayer || [];\r\n      // function gtag(){dataLayer.push(arguments);}\r\n      // gtag('js', new Date());\r\n      // gtag('config', 'UA-200229297-1');\r\n      // ga('set', 'userId', custID);\r\n      dataLayer.push({\r\n          'userId': custID\r\n      });\r\n\r\n       </script>\r\n<style type=\"text/css\"> \r\n    @font-face {\r\n        font-family: \"FoundersGrotesk\";\r\n        src: url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Regular.woff2'}}\") format(\"woff2\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Regular.woff'}}\") format(\"woff\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Regular.otf'}}\") format(\"opentype\");\r\n        font-weight: normal;\r\n        font-style: normal;\r\n        font-display: swap;\r\n\r\n    }\r\n    @font-face {\r\n        font-family: \"FoundersGrotesk-semibold\";\r\n        src: url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Semibold.woff2'}}\") format(\"woff2\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Semibold.woff'}}\") format(\"woff\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Semibold.otf'}}\") format(\"opentype\");\r\n        font-weight: 500;\r\n        font-style: normal;\r\n        font-display: swap;\r\n\r\n    }\r\n    @font-face {\r\n        font-family: \"RecoletaAlt-SemiBold\";\r\n        src: url(\"{{cdn 'assets/fonts/custom-fonts/Recoleta-Alt-SemiBold.woff2'}}\") format(\"woff2\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Recoleta-Alt-SemiBold.woff'}}\") format(\"woff\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Recoleta-Alt-SemiBold.otf'}}\") format(\"opentype\");\r\n        font-style: normal;\r\n        font-weight: 400; \r\n        font-display: swap;     \r\n    }\r\n</style>\r\n{{{ stylesheet '/assets/css/optimized-checkout.css' }}}\r\n{{ getFontsCollection }}\r\n\r\n<script type=\"text/javascript\">\r\n    window.language = {{{langJson 'optimized_checkout'}}};\r\n</script>\r\n\r\n{{{head.scripts}}}\r\n<script defer=\"defer\" src=\"https://code.jquery.com/jquery-3.6.0.min.js\" integrity=\"sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=\" crossorigin=\"anonymous\"></script>\r\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js\"></script>\r\n{{/partial}}\r\n\r\n{{#partial \"page\"}}\r\n<header class=\"checkoutHeader optimizedCheckout-header\">\r\n    <div class=\"checkoutHeader-content\">\r\n        <h1 class=\"is-srOnly\">{{lang 'checkout.title'}}</h1>\r\n        <h2 class=\"checkoutHeader-heading\">\r\n            <a class=\"checkoutHeader-link\" href=\"{{urls.home}}\">\r\n                {{#if checkout.header_image}}\r\n                    <img alt=\"{{settings.store_logo.title}}\" class=\"checkoutHeader-logo\" id=\"logoImage\" src=\"{{ checkout.header_image }}\"/>\r\n                {{ else }}\r\n                    <span class=\"header-logo-text\">{{settings.store_logo.title}}</span>\r\n                {{/if}}\r\n                </a>\r\n        </h2>\r\n    </div>\r\n</header>\r\n<input type=\"hidden\" class=\"checkoutcustomer\" value=\"{{customer.id}}\">\r\n{{{ checkout.checkout_content }}}\r\n\r\n{{{ footer.scripts }}}\r\n<script src=\"{{cdn 'webdav:js/razorpay.js?v='}}{{random 0 999999999999999}}\"></script>\r\n\r\n{{/partial}}\r\n<script>window.__webpack_public_path__ = \"{{cdn 'assets/dist/'}}\";</script>\r\n<script src=\"{{cdn 'assets/dist/theme-bundle.main.js'}}\"></script>\r\n\r\n<script>\r\n    window.stencilBootstrap(\"{{page_type}}\", {{jsContext}}).load();\r\n</script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js\"></script>\r\n<script>\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    \r\n        var p_id = '';\r\n        var pro_id = '';\r\n        var url = '';\r\n        var image = '';\r\n        var p_name = '';\r\n        var pro_name\r\n        var category_id = '';\r\n        var category_name = '';\r\n        var mrp = '';\r\n        var Mrp = '';\r\n        var discount = '';\r\n        var Discount = '';\r\n        var discounted_price = '';\r\n        var Discounted_price = '';\r\n        var Quantity = '';\r\n        var proQuantity = '';\r\n        var email = '';\r\n        var cartAmount = '';\r\n        var cat_id = '';\r\n        var cat_name = '';\r\n        var total_item_in_cart = '';\r\n        var coupons = '';\r\n        var WalletAmount = '';\r\n        var ids = '';\r\n        var itemdata = '';\r\n        var productId = [];\r\n        var amount = [];\r\n        var Email = [];\r\n        var quantity = [];\r\n        var productsDetails = [];\r\n        var productArray = [];\r\n        var pro_quantity = '';\r\n        var customer = document.querySelectorAll(\".cust_id\")[0].value;\r\n        \r\n        if(customer){\r\n          axios({\r\n\t\t\t\t\turl: 'https://bg-sync-api-dev.kapiva.in/api/getcustomerdetails.php',\r\n\t\t\t\t\tmethod: 'post',\r\n\t\t\t\t\tcontentType: \"application/json\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'custId': customer\r\n\t\t\t\t\t},\r\n            }).then((result) => {  \r\n\t\t\t\r\n                     \r\n\t\t\t\t\t           WalletAmount = Number(result.data.amount);\r\n\t\t\t\t\t  \r\n                });\r\n              }else{\r\n                WalletAmount = 0 ;\r\n              }\r\n\r\n        fetch('/api/storefront/cart', {\r\n            credentials: 'include'\r\n        }).then(function (response) {\r\n            return response.json();\r\n        }).then(function (myJson) {\r\n\r\n            if (myJson[0]['coupons'].length > 0) {\r\n\r\n                coupons = myJson[0]['coupons'][0]['code'];\r\n            }else{\r\n              coupons = \"NULL\"\r\n            }\r\n\r\n            cartAmount = myJson[0]['cartAmount'];\r\n            amount.push(myJson[0]['cartAmount'])\r\n            email = myJson[0]['email'];\r\n            if(email){\r\n              email = \"true\";\r\n            }else{\r\n              email = \"false\";\r\n            }\r\n           \r\n            Email.push(email);\r\n            total_item_in_cart = myJson[0]['lineItems']['physicalItems'].length;\r\n            for (var i = 0; i < myJson[0]['lineItems']['physicalItems'].length; i++) {\r\n                var pro_id = myJson[0]['lineItems']['physicalItems'][i]['productId'];\r\n                var Quantity = myJson[0]['lineItems']['physicalItems'][i]['quantity'];\r\n                 proQuantity = Quantity;\r\n                if(pro_quantity == ''){\r\n                  pro_quantity = Quantity.toString();\r\n                              }else{\r\n                                pro_quantity = pro_quantity+','+Quantity;\r\n                              }\r\n               \r\n                if(ids == ''){\r\n                  ids = pro_id;\r\n                }else{\r\n                  ids = ids+','+pro_id;\r\n                }\r\n            }\r\n    quantity.push(pro_quantity);\r\n    productId.push(ids);  \r\n   \r\n    var query = `query ExtendedProductsById {\r\n  site {\r\n    products(entityIds: [`+ ids + `]) {\r\n      edges {\r\n        node {\r\n          id\r\n          sku\r\n          entityId\r\n          name\r\n          path\r\n          inventory{\r\n          isInStock\r\n          aggregated{\r\n             availableToSell\r\n             warningLevel\r\n          }\r\n         }\r\n          categories\r\n          {\r\n          edges\r\n            {\r\n              node\r\n              {\r\n                id\r\n                name\r\n                \r\n              }\r\n            } \r\n          }\r\n          plainTextDescription\r\n      defaultImage {\r\n        ...ImageFields\r\n      }\r\n      images {\r\n        edges {\r\n          node {\r\n            ...ImageFields\r\n          }\r\n        }\r\n      }\r\n          \r\n          prices (includeTax:true){\r\n            price {\r\n              ...MoneyFields\r\n            }\r\n            priceRange {\r\n              min {\r\n                ...MoneyFields\r\n              }\r\n              max {\r\n                ...MoneyFields\r\n              }\r\n            }\r\n            salePrice {\r\n              ...MoneyFields\r\n            }\r\n            retailPrice {\r\n              ...MoneyFields\r\n            }\r\n            saved {\r\n              ...MoneyFields\r\n            }\r\n            bulkPricing {\r\n              minimumQuantity\r\n              maximumQuantity\r\n              ... on BulkPricingFixedPriceDiscount {\r\n                price\r\n              }\r\n              ... on BulkPricingPercentageDiscount {\r\n                percentOff\r\n              }\r\n              ... on BulkPricingRelativePriceDiscount {\r\n                priceAdjustment\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\nfragment ImageFields on Image {\r\n  url640wide: url(width: 640)\r\n}\r\nfragment MoneyFields on Money {\r\n      value\r\n      currencyCode\r\n    }`;\r\n        axios({\r\n                  url: '/graphql',\r\n                  method: 'post',\r\n                  contentType: \"application/json\",\r\n                  headers: {\r\n                      'Authorization': 'Bearer {{ settings.storefront_api.token }}'\r\n                 },\r\n                  data: {\r\n                    query:query\r\n                  }\r\n                }).then((result) => {     \r\n                 \r\n              var getdata = result.data.data.site.products.edges;\r\n              \r\n              getdata.forEach(function (value, index) {\r\n                       \r\n                        var alldata = value.node;\r\n                        \r\n                        if (alldata) {\r\n                          pro_id = alldata.entityId;\r\n                          pro_name = alldata.name;\r\n                          image = alldata.defaultImage.url640wide;\r\n                          url = alldata.path;\r\n                          if(p_id == '' && p_name == ''){\r\n                            p_id = alldata.entityId;\r\n                            p_id = p_id.toString();\r\n                            p_name = alldata.name;\r\n                          }else{\r\n                            p_id = p_id+','+alldata.entityId;\r\n                            p_name = p_name+','+alldata.name;\r\n                          }\r\n                           var actual = '';\r\n                            if (alldata.prices.retailPrice != null) {\r\n                              actual = alldata.prices.retailPrice.value;\r\n                              Mrp = alldata.prices.retailPrice.value;\r\n                              if(mrp == ''){\r\n                                mrp = alldata.prices.retailPrice.value;\r\n                                mrp = mrp.toString();\r\n                              }else{\r\n                                mrp = mrp+','+alldata.prices.retailPrice.value;\r\n                              }\r\n                            }\r\n                            var sale = '';\r\n                            if (alldata.prices.salePrice != null) {\r\n                              sale = alldata.prices.salePrice.value;\r\n                              Discounted_price = alldata.prices.salePrice.value;\r\n                                if(discounted_price == ''){\r\n                                  discounted_price = alldata.prices.salePrice.value;\r\n                                  discounted_price = discounted_price.toString();\r\n                              }else{\r\n                                discounted_price = discounted_price+','+alldata.prices.salePrice.value;\r\n                              }\r\n                            }else{\r\n                              Discounted_price = 0;\r\n                              if(discounted_price == ''){\r\n                                  discounted_price = 0;\r\n                                  discounted_price = discounted_price.toString();\r\n                              }else{\r\n                                discounted_price = discounted_price+','+0;\r\n                              }\r\n                            }\r\n                            \r\n                            if (sale != null && actual != null && sale != actual) {\r\n                                var discount_price = actual - sale;\r\n                                \r\n                                var discount_data = (discount_price * 100) / actual;\r\n                                discount_data = discount_data.toFixed(2)\r\n                                Discount = discount_data + \"% OFF\";\r\n                                if(discount == ''){\r\n                                  discount = discount_data + \"% OFF\";\r\n                              }else{\r\n                                discount = discount+','+discount_data + \"% OFF\";\r\n                              }\r\n                            }else{\r\n                              Discount = \"0% OFF\";\r\n                              if(discount == ''){\r\n                                  discount = \"0% OFF\";\r\n                              }else{\r\n                                discount = discount+','+\"0% OFF\";\r\n                              }\r\n                            }\r\n                           \r\n                             var category = alldata.categories.edges;\r\n                             var category_id = '';\r\n                              var category_name = '';\r\n                              category.forEach(function (value, index) {\r\n                               if(category_id == '' && category_name == ''){\r\n                                   var cat_id = value.node.id;\r\n                                   var splited_url = atob(cat_id);\r\n                                   var categoryid = splited_url.split(\"Category:\");\r\n                                    category_id = categoryid[1];\r\n                                   category_name = value.node.name\r\n                                 }\r\n                                  else{\r\n                                    var splited_url = atob(value.node.id);\r\n                                    var categoryid= splited_url.split(\"Category:\");\r\n                                     var catid = categoryid[1];\r\n                                      category_id = category_id+','+catid;\r\n                                      category_name = category_name+','+value.node.name;\r\n                                }\r\n\r\n                            })\r\n                            if(cat_id == '' && cat_name == ''){\r\n                              cat_id = category_id;\r\n                              cat_name = category_name;\r\n                            }else{\r\n                              cat_id = cat_id+','+category_id;\r\n                              cat_name = cat_name+','+category_name;\r\n                            }\r\n                          /***array of obj for webengage***/\r\n                        var Category_id = [];\r\n                        var Category_name = [];\r\n                        category.forEach(function (value, index) {\r\n                            var c_id = value.node.id;\r\n                                   var splited_url = atob(c_id);\r\n                                   var catid = splited_url.split(\"Category:\");\r\n                                   var Cat_id = catid[1];\r\n                                   var cat_name = value.node.name\r\n                              Category_id.push(Cat_id);\r\n                             Category_name.push(cat_name);\r\n                   })\r\n         \r\n            var categories = {Category_id,Category_name}; \r\n                            var obj = {\r\n                                \"Product_id\": pro_id,\r\n                                \"Product_name\": pro_name,\r\n                                \"Category_id\": category_id,\r\n                                \"Category_name\": category_name,\r\n                                \"MRP\": Mrp,\r\n                                \"Discount\": Discount,\r\n                                \"Discount_Price\": Discounted_price,\r\n                                \"Product_url\": url,\r\n                                \"Image_url\": image,\r\n                                \"Quantity\": proQuantity\r\n                            };\r\n                            var product_array = {\r\n                                \"Product_id\": pro_id,\r\n                                \"Product_name\": pro_name,\r\n                                \"categories\": categories,\r\n                                \"MRP\": Mrp,\r\n                                \"Discount\": Discount,\r\n                                \"Discount_Price\": Discounted_price,\r\n                                \"Product_url\": url,\r\n                                \"Image_url\": image,\r\n                                \"Quantity\": proQuantity\r\n                            };\r\n                            productArray.push(product_array);\r\n                            productsDetails.push(obj);\r\n                           \r\n                        }\r\n                      })\r\n                  \r\n                 \r\n                  window.dataLayer = window.dataLayer || [];\r\n                            dataLayer.push({\r\n                            'event': 'begin_checkout',\r\n                              \"items\": [\r\n                                {\r\n                                  \"id\": p_id,\r\n                                  \"name\": p_name,\r\n                                  \"quantity\": pro_quantity,\r\n                                  \"price\": mrp\r\n                                }\r\n                              ],\r\n                              \"coupon\": \"\"\r\n                            }); \r\n                     \r\n                   webengage.track(\"Initiate Checkout\", {\r\n\r\n                            \"Product_ID\": p_id,\r\n                            \"Product_Name\": p_name,\r\n                            \"Category_ID\": cat_id,\r\n                            \"Category_Name\": cat_name,\r\n                            \"MRP\": mrp,\r\n                            \"Discount\": discount,\r\n                            \"Discount_Price\": discounted_price,\r\n                            \"Quantity\": pro_quantity,\r\n                            \"Logged_in\": email,\r\n                            \"Coupon_code_applied\": coupons,\r\n                            \"Wallet_Amount\": WalletAmount,\r\n                            \"total_item_in_cart\": total_item_in_cart,\r\n                            \"Cart_value\": cartAmount\r\n                         });\r\n        });\r\n      });\r\n      var setintcheckout = setInterval(function(){\r\n      if(document.querySelectorAll('#checkout-payment-continue').length > 0){\r\n        clearInterval(setintcheckout)\r\n       \r\n        document.querySelectorAll('#checkout-payment-continue').forEach(item => {\r\n            item.addEventListener('click', function (e) {\r\n      \r\n        \r\n            var coupon = document.querySelectorAll(\".optimizedCheckout-contentSecondary\")[0].textContent;\r\n            if(coupon){}else{coupon = \"NULL\"}\r\n            var paymentmethod = document.querySelectorAll('.form-checklist-checkbox:checked')[0].value;\r\n            \r\n            var shipping = document.querySelectorAll(\".shippingOption-price\")[0].textContent;\r\n           if (shipping == \"₹0.00\" || shipping == \"₹0\") {\r\n                shipping = \"YES\"\r\n            } else {\r\n                shipping = \"NO\"\r\n            }\r\n                    \r\n            var finaldata = JSON.stringify(productsDetails);\r\n            var p_array = JSON.stringify(productArray);\r\n                                window.dataLayer = window.dataLayer || [];\r\n                                      dataLayer.push({\r\n                                      'event': 'begin_checkout',\r\n                                        \"items\": [\r\n                                          {\r\n                                            \"id\": p_id,\r\n                                            \"name\": p_name,\r\n                                            \"quantity\": quantity[0],\r\n                                            \"price\": mrp\r\n                                          }\r\n                                        ],\r\n                                        \"coupon\": \"\"\r\n                                      });\r\n                            \r\n                                      webengage.track(\"Inititate Payment\", {\r\n                                          \"Products\" : productsDetails,\r\n                                           \"productArray\": productArray,\r\n                                          \"Payment_Type\": paymentmethod,\r\n                                          \"Shipping-free\": shipping,\r\n                                          \"Logged_in\": Email[0],\r\n                                          \"Coupon_code_applied\": coupon,\r\n                                          \"Wallet_Amount\": WalletAmount,\r\n                                          \"Product_ID\": p_id,\r\n                                          \"Product_Name\": p_name,\r\n                                          \"Category_ID\": cat_id,\r\n                                          \"Category_Name\": cat_name,\r\n                                          \"MRP\": mrp,\r\n                                          \"Discount\": discount,\r\n                                          \"Discount_Price\": discounted_price,\r\n                                          \"Quantity\": quantity[0],\r\n                                          \"total_item_in_cart\": total_item_in_cart,\r\n                                          \"Cart_value\": amount[0]\r\n                                      });\r\n                  })\r\n                });\r\n              }\r\n              },2000)\r\n              var setintcheckout2 = setInterval(function(){\r\n      if(document.querySelectorAll('.show-razor').length > 0){\r\n        clearInterval(setintcheckout2)\r\n                document.querySelectorAll('.show-razor').forEach(item => {\r\n            item.addEventListener('click', function (e) {\r\n              e.preventDefault()\r\n                        var coupon = document.querySelectorAll(\".optimizedCheckout-contentSecondary\")[0].textContent;\r\n                        if(coupon){}else{coupon = \"NULL\"}\r\n                        var paymentmethod = document.querySelectorAll('.form-checklist-checkbox:checked')[0].value;\r\n                        \r\n                        var shipping = document.querySelectorAll(\".shippingOption-price\")[0].textContent;\r\n                       if (shipping == \"₹0.00\" || shipping == \"₹0\") {\r\n                            shipping = \"YES\"\r\n                        } else {\r\n                            shipping = \"NO\"\r\n                        }\r\n                                \r\n                        var finaldata = JSON.stringify(productsDetails);\r\n                        var p_array = JSON.stringify(productArray);\r\n                                            window.dataLayer = window.dataLayer || [];\r\n                                                  dataLayer.push({\r\n                                                  'event': 'begin_checkout',\r\n                                                    \"items\": [\r\n                                                      {\r\n                                                        \"id\": p_id,\r\n                                                        \"name\": p_name,\r\n                                                        \"quantity\": quantity[0],\r\n                                                        \"price\": mrp\r\n                                                      }\r\n                                                    ],\r\n                                                    \"coupon\": \"\"\r\n                                                  });\r\n                                        \r\n                                                  webengage.track(\"Inititate Payment\", {\r\n                                                      \"Products\" : productsDetails,\r\n                                                       \"productArray\": productArray,\r\n                                                      \"Payment_Type\": paymentmethod,\r\n                                                      \"Shipping-free\": shipping,\r\n                                                      \"Logged_in\": Email[0],\r\n                                                      \"Coupon_code_applied\": coupon,\r\n                                                      \"Wallet_Amount\": WalletAmount,\r\n                                                      \"Product_ID\": p_id,\r\n                                                      \"Product_Name\": p_name,\r\n                                                      \"Category_ID\": cat_id,\r\n                                                      \"Category_Name\": cat_name,\r\n                                                      \"MRP\": mrp,\r\n                                                      \"Discount\": discount,\r\n                                                      \"Discount_Price\": discounted_price,\r\n                                                      \"Quantity\": quantity[0],\r\n                                                      \"total_item_in_cart\": total_item_in_cart,\r\n                                                      \"Cart_value\": amount[0]\r\n                                                  });\r\n                              })\r\n                            })\r\n                          }\r\n                        \r\n                        },2000);\r\n          \r\n    })\r\n\r\n</script>\r\n\r\n{{> layout/empty}}\r\n"}
