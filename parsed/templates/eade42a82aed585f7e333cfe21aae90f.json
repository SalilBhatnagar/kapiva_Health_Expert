{"layout/empty":"<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>{{ head.title }}</title>\r\n    {{{ head.meta_tags }}}\r\n    {{{ head.config }}}\r\n\r\n    <link href=\"{{ head.favicon }}\" rel=\"shortcut icon\">\r\n    {{#block \"head\"}}{{/block}}\r\n</head>\r\n<body>\r\n    {{#block \"page\"}}{{/block}}\r\n</body>\r\n</html>\r\n","pages/custom/page/custom-order-confirmation":"{{#partial \"head\"}}\r\n{{{ checkout.checkout_head }}}\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n<link href=\"https://cdn11.bigcommerce.com/shared/css/open_sans-5ec63c5b7015207649f715d5bf81d7d45e5a5496.css\" rel=\"stylesheet\" type=\"text/css\">\r\n<link href=\"https://cdn11.bigcommerce.com/shared/microapp/checkout/dist/checkout-dc6265ae.css\" rel=\"stylesheet\" type=\"text/css\">\r\n<style type=\"text/css\"> \r\n    @font-face {\r\n        font-family: \"FoundersGrotesk\";\r\n        src: url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Regular.woff2'}}\") format(\"woff2\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Regular.woff'}}\") format(\"woff\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Regular.otf'}}\") format(\"opentype\");\r\n        font-weight: normal;\r\n        font-style: normal;\r\n        font-display: swap;\r\n\r\n    }\r\n    @font-face {\r\n        font-family: \"FoundersGrotesk-semibold\";\r\n        src: url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Semibold.woff2'}}\") format(\"woff2\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Semibold.woff'}}\") format(\"woff\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Founders-Grotesk-Semibold.otf'}}\") format(\"opentype\");\r\n        font-weight: 500;\r\n        font-style: normal;\r\n        font-display: swap;\r\n\r\n    }\r\n    @font-face {\r\n        font-family: \"RecoletaAlt-SemiBold\";\r\n        src: url(\"{{cdn 'assets/fonts/custom-fonts/Recoleta-Alt-SemiBold.woff2'}}\") format(\"woff2\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Recoleta-Alt-SemiBold.woff'}}\") format(\"woff\"), \r\n        url(\"{{cdn 'assets/fonts/custom-fonts/Recoleta-Alt-SemiBold.otf'}}\") format(\"opentype\");\r\n        font-style: normal;\r\n        font-weight: 400; \r\n        font-display: swap;     \r\n    }\r\n</style>\r\n{{{ stylesheet '/assets/css/optimized-checkout.css' }}}\r\n{{ getFontsCollection }}\r\n<!-- Google Analytics Snippet -->\r\n<!-- Global site tag (gtag.js) - Google Analytics -->\r\n\r\n<script type=\"text/javascript\">\r\n   window.language = {{{langJson 'optimized_checkout'}}};\r\n</script>\r\n{{{head.scripts}}}\r\n{{/partial}}\r\n{{#partial \"page\"}}\r\n<header class=\"checkoutHeader optimizedCheckout-header\">\r\n   <div class=\"checkoutHeader-content\">\r\n      <h1 class=\"is-srOnly\">{{lang 'checkout.title'}}</h1>\r\n      <h2 class=\"checkoutHeader-heading\">\r\n         <a class=\"checkoutHeader-link\" href=\"{{urls.home}}\">\r\n         <img alt=\"{{settings.store_logo.title}}\" class=\"checkoutHeader-logo\" id=\"logoImage\" src=\"https://cdn11.bigcommerce.com/s-q0ghktat3g/product_images/subtract_1617795361__77099.original_1625657373.png\"/>\r\n         </a>\r\n      </h2>\r\n   </div>\r\n</header>\r\n{{{ checkout.order_confirmation_content }}}\r\n<div id=\"checkout-app\" class=\"checkout-custom-app\">\r\n   <div class=\"layout optimizedCheckout-contentPrimary\">\r\n      <div class=\"layout-main\">\r\n         <div class=\"orderConfirmation\">\r\n            <h1 class=\"optimizedCheckout-headingPrimary\" data-test=\"order-confirmation-heading\"></h1>\r\n            <section class=\"orderConfirmation-section\">\r\n               <p data-test=\"order-confirmation-order-number-text\" class=\"order-confirmation-order-number-text\"><span>Your order number is <strong></strong></span></p>\r\n               <p data-test=\"order-confirmation-order-status-text\"><span>You will receive an email with your purchase details shortly. Please also check your Spam folder. In case of questions or concerns regarding the same, email us at <a target=\"_top\" href=\"mailto:info@kapiva.in\">info@kapiva.in</a> or call us at <a href=\"tel:8080177000\">+91-8080 177 000</a>.</span></p>\r\n            </section>\r\n            <div class=\"continueButtonContainer\">\r\n               <a href=\"{{urls.home}}\" target=\"_top\">\r\n               <button class=\"button button--tertiary optimizedCheckout-buttonSecondary\" type=\"button\">Continue Shopping »</button>\r\n               </a>\r\n            </div>\r\n         </div>\r\n      </div>\r\n      <aside class=\"layout-cart\">\r\n         <article class=\"cart optimizedCheckout-orderSummary\" data-test=\"cart\">\r\n            <header class=\"cart-header\">\r\n               <h3 class=\"cart-title optimizedCheckout-headingSecondary\">Order Summary</h3>\r\n               <a class=\"cart-header-link\" id=\"cart-print-link\" onclick=\"window.print()\">\r\n                  <div class=\"icon\">\r\n                     <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                        <path d=\"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z\"></path>\r\n                     </svg>\r\n                  </div>\r\n                  Print\r\n               </a>\r\n            </header>\r\n            <section class=\"cart-section optimizedCheckout-orderSummary-cartSection\">\r\n               <h3 class=\"cart-section-heading optimizedCheckout-contentPrimary\" data-test=\"cart-count-total\"></h3>\r\n               <ul aria-live=\"polite\" class=\"productList\"></ul>\r\n            </section>\r\n            <section class=\"cart-section optimizedCheckout-orderSummary-cartSection\">\r\n               <div data-test=\"cart-subtotal\">\r\n                  <div aria-live=\"polite\" class=\"cart-priceItem optimizedCheckout-contentPrimary cart-priceItem--subtotal\"><span class=\"cart-priceItem-label\"><span data-test=\"cart-price-label\">Subtotal  </span></span><span class=\"cart-priceItem-value\"><span data-test=\"cart-price-value\"></span></span>\r\n                  </div>\r\n               </div>\r\n               <!--<div data-test=\"cart-coupon\"><div aria-live=\"polite\" class=\"cart-priceItem optimizedCheckout-contentPrimary\"><span class=\"cart-priceItem-label\"><span data-test=\"cart-price-label\">10% off each item</span></span><span class=\"cart-priceItem-value\"><span data-test=\"cart-price-value\">-₹333</span></span><span class=\"cart-priceItem-postFix optimizedCheckout-contentSecondary\" data-test=\"cart-price-code\">Test10</span></div></div>-->\r\n               <div data-test=\"cart-shipping\">\r\n                  <div aria-live=\"polite\" class=\"cart-priceItem optimizedCheckout-contentPrimary cart-priceItem--shipping-cost\"><span class=\"cart-priceItem-label\"><span data-test=\"cart-price-label\">Shipping  </span></span><span class=\"cart-priceItem-value\"><span data-test=\"cart-price-value\">Free</span></span>\r\n                  </div>\r\n               </div>\r\n               <div data-test=\"cart-taxes\">\r\n                  <div aria-live=\"polite\" class=\"cart-priceItem optimizedCheckout-contentPrimary cart-priceItem--subtotal-tax\"><span class=\"cart-priceItem-label\"><span data-test=\"cart-price-label\">Tax  </span></span><span class=\"cart-priceItem-value\"><span data-test=\"cart-price-value\">₹0</span></span>\r\n                  </div>\r\n               </div>\r\n            </section>\r\n            <section class=\"cart-section optimizedCheckout-orderSummary-cartSection\">\r\n               <div data-test=\"cart-total\">\r\n                  <div aria-live=\"polite\" class=\"cart-priceItem optimizedCheckout-contentPrimary cart-priceItem--total\"><span class=\"cart-priceItem-label\"><span data-test=\"cart-price-label\">Total (INR)  </span></span><span class=\"cart-priceItem-value\"><span data-test=\"cart-price-value\"></span></span>\r\n                  </div>\r\n               </div>\r\n            </section>\r\n         </article>\r\n      </aside>\r\n   </div>\r\n</div>\r\n<div class=\"CatSlider-Wrap browsing_history\">\r\n  <div class=\"featured-section\">\r\n    <h2 class=\"page-heading text-center\">Inspired by Your Browsing history</h2>\r\n  </div>\r\n  <div class=\"product-space browsing_history\">\r\n  </div>\r\n</div>\r\n{{{ footer.scripts }}}\r\n{{/partial}}\r\n{{> layout/empty}}\r\n<link preload rel=\"stylesheet\" href=\"{{cdn 'assets/scss/custom/slick.min.css'}}\" crossorigin=\"anonymous\"\r\n  referrerpolicy=\"no-referrer\" />\r\n\r\n<link preload rel=\"stylesheet\" href=\"{{cdn 'assets/scss/custom/owl.carousel.min.css'}}\">\r\n<link preload rel=\"stylesheet\" href=\"{{cdn 'assets/scss/custom/owl.theme.default.min.css'}}\">\r\n<script src=\"https://code.jquery.com/jquery-3.6.0.min.js\"\r\n  integrity=\"sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=\" crossorigin=\"anonymous\"></script>\r\n<script defer=\"defer\" src=\"{{cdn 'assets/js/owl.carousel.min.js'}}\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js\"></script>\r\n<script src=\"https://vuex.vue.ai/embed-code/embed_code.js\" async=\"async\" defer=\"defer\" data-msd-client-id=\"7044932c-da92-4449-870a-776a73e3eb20\" data-msd-region=\"ap-southeast-1\"></script>\r\n<input type=\"hidden\" value=\"{{customer.id}}\" class=\"customer_id\">\r\n<script>\r\n    function getCookie(e) {\r\n       for (var t = e + \"=\", o = decodeURIComponent(document.cookie).split(\";\"), n = 0; n < o.length; n++) {\r\n           for (var i = o[n];\r\n               \" \" == i.charAt(0);) i = i.substring(1);\r\n           if (0 == i.indexOf(t)) return i.substring(t.length, i.length)\r\n       }\r\n       return \"\"\r\n    }\r\n   \r\n   $(document).ready(function () {\r\n       var cat_id = cat_name = p_id = p_name = p_price = p_quantity =  '';\r\n     var discounted_amount = '';\r\n     var Coupon_Code_Applied = '';\r\n     var Coupon_Code_Applied_Name = '';\r\n     var Coupon_Code_Applied_Amount = '';\r\n     var Purchase_Amount = '';\r\n     var Phone_Number = '';\r\n     var Email_Address = '';\r\n     var First_Name = '';\r\n     var Last_Name = '';\r\n     var Order_Address_City = Order_Address_Pin = Payment_Status = '';\r\n     var payment_method = [];\r\n        var order_data = getCookie('checkout_order');\r\n       \r\n        var order_id = '';\r\n        if(order_data){\r\n            var order_data = JSON.parse(order_data);\r\n            var order_id = (order_data.order_id && order_data.order_id > 0 ) ? order_data.order_id : order_data.id;\r\n           \r\n        }\r\n         fetch('/api/storefront/order/'+order_id, {credentials: 'include'})\r\n         .then(function(response) {\r\n             return response.json();\r\n         })\r\n         .then(function(orderData) {\r\n             if( orderData.status == 404){\r\n                 window.location.href = '/cart.php';\r\n             }\r\n             order_id  = orderData['orderId'];\r\n            user_email = orderData['billingAddress']['email'];\r\n            total_price = orderData['baseAmount'];\r\n            var products = [];\r\n            let transaction = {\r\n              'event': 'purchase',\r\n              'transactionId': orderData['orderId'],\r\n              'transactionTotal': orderData['orderAmount'],\r\n              'transactionTax': orderData['taxTotal'],\r\n              'transactionShipping': orderData['shippingCostTotal'],\r\n              'transactionProducts' :[]\r\n             };\r\n\r\n             for (var i = 0; i < orderData['lineItems']['physicalItems'].length; i++) {\r\n                var obj = {\r\n                    \r\n                   \"orderedItemId\" : orderData['lineItems']['physicalItems'][i]['productId'],\r\n                    \"orderedItemSku\" : orderData['lineItems']['physicalItems'][i]['sku'],\r\n                    \"orderedItemPrice\" : orderData['lineItems']['physicalItems'][i]['salePrice'],\r\n                    \"orderedItemQuantity\": orderData['lineItems']['physicalItems'][i]['quantity'],\r\n                    \"orderedItemGTIN\": \"None\"\r\n                };\r\n                products.push(obj);\r\n                // for transactions\r\n                let lineItem ={\r\n                  'id': orderData['lineItems']['physicalItems'][i]['productId'],\r\n                  'sku': orderData['lineItems']['physicalItems'][i]['sku'],\r\n                  'name': orderData['lineItems']['physicalItems'][i]['name'],\r\n                  'price':orderData['lineItems']['physicalItems'][i]['salePrice'],\r\n                  'quantity': orderData['lineItems']['physicalItems'][i]['quantity']\r\n                }\r\n                  transaction.transactionProducts.push(lineItem)\r\n             }\r\n\r\n            var selector = localStorage.getItem('oid');\r\n            if(selector != order_id){\r\n                 localStorage.removeItem('oid');\r\n                localStorage.setItem('oid', order_id);\r\n             window.dataLayer = window.dataLayer || [];\r\n            dataLayer.push({orderedItems:products});\r\n            dataLayer.push(transaction);\r\n            }\r\n              $('.optimizedCheckout-headingPrimary').text('Thank you for shopping with us, '+orderData.billingAddress.firstName+'!');\r\n              $('.order-confirmation-order-number-text span strong').text(orderData.orderId);\r\n              $('.cart-priceItem--total .cart-priceItem-value span').text('₹'+orderData.orderAmount);\r\n              $('.cart-priceItem--subtotal .cart-priceItem-value span').text('₹'+orderData.baseAmount);\r\n              $('.cart-priceItem--subtotal-tax .cart-priceItem-value span').text('₹'+orderData.taxTotal);\r\n              $('.cart-priceItem--shipping-cost .cart-priceItem-value span').text((orderData.shippingCostTotal > 0) ? '₹'+orderData.shippingCostTotal : \"Free\");\r\n            \r\n             order_total = orderData.orderAmount;\r\n             \r\n             \r\n             var total_items = orderData.lineItems.physicalItems.length;\r\n             $('.cart-section-heading').text(total_items + (( total_items > 1) ? ' Items' :  ' Item'));\r\n             orderData.lineItems.physicalItems.forEach(function(item, index) {\r\n                 $('.optimizedCheckout-orderSummary-cartSection ul.productList').append('<li class=\"productList-item is-visible\">'+\r\n                             '<div class=\"product\" data-test=\"cart-item\">'+\r\n                                 '<figure class=\"product-column product-figure\"><img alt=\"'+item.name+'\" data-test=\"cart-item-image\" src=\"'+item.imageUrl+'\"></figure>'+\r\n                                 '<div class=\"product-column product-body\">'+\r\n                                     '<h5 class=\"product-title optimizedCheckout-contentPrimary\" data-test=\"cart-item-product-title\">'+item.quantity+' x '+item.name+'</h5>'+\r\n                                     '<ul class=\"product-options optimizedCheckout-contentSecondary\" data-test=\"cart-item-product-options\"></ul>'+\r\n                                 '</div>'+\r\n                                 '<div class=\"product-column product-actions\">'+\r\n                                     '<div class=\"product-price optimizedCheckout-contentPrimary\" data-test=\"cart-item-product-price\">₹'+item.salePrice+'</div>'+\r\n                                 '</div>'+\r\n                             '</div>'+\r\n                         '</li>');\r\n             });\r\n          //webengage code start\r\n           $.ajax\r\n          ({ \r\n            type: \"POST\",\r\n            url: \"https://bg-sync-api-dev.kapiva.in/api/getorderdetails.php\",\r\n            async: false,\r\n            headers: { oid: order_id },\r\n            success: function (html) {\r\n              var paymentMethod = JSON.parse(html);\r\n              payment_method.push(paymentMethod.method);\r\n            },\r\n          });\r\n         \r\n        if (orderData['coupons'].length > 0) {\r\n           Coupon_Code_Applied = \"true\";\r\n           Coupon_Code_Applied_Name = orderData['coupons'][0]['code'];\r\n           Coupon_Code_Applied_Amount = orderData['coupons'][0]['discountedAmount'];\r\n        }else{\r\n          Coupon_Code_Applied = \"false\";\r\n          Coupon_Code_Applied_Name = \"NULL\";\r\n          Coupon_Code_Applied_Amount = 0;\r\n        }\r\n        var ids = ''; \r\n         Purchase_Amount = orderData['orderAmount'];\r\n         Phone_Number = Number(orderData['billingAddress']['phone']);\r\n        Email_Address = orderData['billingAddress']['email'];\r\n        First_Name = orderData['billingAddress']['firstName'];\r\n        Last_Name = orderData['billingAddress']['lastName'];\r\n        Order_Address_City = orderData['billingAddress']['city'];\r\n        Order_Address_Pin = orderData['billingAddress']['postalCode'];\r\n        Payment_Status = orderData['status'];\r\n        for (var i = 0; i < orderData['lineItems']['physicalItems'].length; i++) {\r\n\r\n          var alldata = orderData['lineItems']['physicalItems'][i];\r\n          var Product_Id = alldata['productId'];\r\n          var Product_Name = alldata['name'];\r\n          var Product_Price = alldata['salePrice'];\r\n          var Product_Quantity = alldata['quantity'];\r\n          if(p_id == '' && p_name == '' && p_price == '' && p_quantity == ''){\r\n            p_id = Product_Id.toString();\r\n            p_name = Product_Name;\r\n            p_price = Product_Price.toString();\r\n            p_quantity = Product_Quantity.toString();\r\n          }else{\r\n            p_id = p_id+','+Product_Id;\r\n            p_name = p_name+','+Product_Name;\r\n            p_price = p_price+','+Product_Price;\r\n            p_quantity = p_quantity+','+Product_Quantity;\r\n          }\r\n         if(ids == ''){\r\n                  ids = Product_Id;\r\n                }else{\r\n                  ids = ids+','+Product_Id;\r\n                }\r\n              }\r\n              var query = `query ExtendedProductsById {\r\n          site {\r\n            products(entityIds: [`+ ids + `]) {\r\n              edges {\r\n                node {\r\n                  id\r\n                  entityId\r\n                  name\r\n                  inventory{\r\n                  isInStock\r\n                  aggregated{\r\n                    availableToSell\r\n                    warningLevel\r\n                  }\r\n                }\r\n                  categories\r\n                  {\r\n                  edges\r\n                    {\r\n                      node\r\n                      {\r\n                        id\r\n                        name\r\n                        \r\n                      }\r\n                    } \r\n                  }\r\n                  \r\n                  prices (includeTax:true){\r\n                    price {\r\n                      ...MoneyFields\r\n                    }\r\n                    priceRange {\r\n                      min {\r\n                        ...MoneyFields\r\n                      }\r\n                      max {\r\n                        ...MoneyFields\r\n                      }\r\n                    }\r\n                    salePrice {\r\n                      ...MoneyFields\r\n                    }\r\n                    retailPrice {\r\n                      ...MoneyFields\r\n                    }\r\n                    saved {\r\n                      ...MoneyFields\r\n                    }\r\n                    bulkPricing {\r\n                      minimumQuantity\r\n                      maximumQuantity\r\n                      ... on BulkPricingFixedPriceDiscount {\r\n                        price\r\n                      }\r\n                      ... on BulkPricingPercentageDiscount {\r\n                        percentOff\r\n                      }\r\n                      ... on BulkPricingRelativePriceDiscount {\r\n                        priceAdjustment\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        fragment MoneyFields on Money {\r\n              value\r\n              currencyCode\r\n            }`;\r\n          $.ajax({\r\n            url: \"/graphql\", \r\n            contentType: \"application/json\",\r\n            type: 'POST',\r\n            async: false,\r\n            headers: {\r\n              'Authorization': 'Bearer {{ settings.storefront_api.token }}'\r\n            },\r\n            data: JSON.stringify({ query: query }),\r\n            success: function (productsData) {\r\n              var getdata = productsData.data.site.products.edges;\r\n                      $(getdata).each(function(index, value){ \r\n                        var alldata = value.node;\r\n                  if (alldata) {\r\n                 \r\n                 if(alldata.prices.saved != null){\r\n                   if(discounted_amount == ''){\r\n                   discounted_amount = alldata.prices.saved.value;\r\n                   discounted_amount = discounted_amount.toString();\r\n                  }\r\n                   else{ discounted_amount = discounted_amount+','+alldata.prices.saved.value;}\r\n                  \r\n                 }else{\r\n                  if(discounted_amount == ''){\r\n                    discounted_amount = 0;\r\n                    discounted_amount = discounted_amount.toString();\r\n                              }else{\r\n                                discounted_amount = discounted_amount+','+0;\r\n                              }\r\n                }\r\n                var category = alldata.categories.edges;\r\n                var category_id = '';\r\n                var category_name = '';\r\n                $(category).each(function (index, value) {\r\n                               if(category_id == '' && category_name == ''){\r\n                                   var cat_id = value.node.id;\r\n                                   var splited_url = atob(cat_id);\r\n                                   var categoryid = splited_url.split(\"Category:\");\r\n                                    category_id = categoryid[1];\r\n                                   category_name = value.node.name\r\n                                 }\r\n                                  else{\r\n                                    var splited_url = atob(value.node.id);\r\n                                    var categoryid= splited_url.split(\"Category:\");\r\n                                     var catid = categoryid[1];\r\n                                      category_id = category_id+','+catid;\r\n                                      category_name = category_name+','+value.node.name;\r\n                                }\r\n\r\n                            })\r\n                            if(cat_id == '' && cat_name == ''){\r\n                              cat_id = category_id;\r\n                              cat_name = category_name;\r\n                            }else{\r\n                              cat_id = cat_id+','+category_id;\r\n                              cat_name = cat_name+','+category_name;\r\n                            }\r\n              \r\n              }\r\n            });\r\n            },\r\n          });\r\n          webengage.track(\"Payment success\", {\r\n                  \"Product_Id\": p_id,\r\n                  \"Product_Name\": p_name,\r\n                  \"Product_Price\": p_price,\r\n                  \"Discounted_amount\": discounted_amount,\r\n                  \"Product_Quantity\": p_quantity,\r\n                  \"Purchase_Amount\": Purchase_Amount,\r\n                  \"Phone_Number\": Phone_Number,\r\n                  \"Email_Address\": Email_Address,\r\n                  \"First_Name\": First_Name,\r\n                  \"Last_Name\": Last_Name,\r\n                  \"Cashback_Earned_Amount\": Coupon_Code_Applied_Amount,\r\n                  \"Payment_Mode\": payment_method[0],\r\n                  \"Payment_Status\": Payment_Status,\r\n                  \"Coupon_Code_Applied\": Coupon_Code_Applied,\r\n                  \"Coupon_Code_Applied_Name\": Coupon_Code_Applied_Name,\r\n                  \"Coupon_Code_Applied_Amount\": Coupon_Code_Applied_Amount\r\n\r\n\r\n                });\r\n\r\n                webengage.track(\"Delivery_Details\", {\r\n                  \"Product_Id\": p_id,\r\n                  \"Product_Name\": p_name,\r\n                  \"Category_ID\": cat_id,\r\n                  \"Category_Name\": cat_name,\r\n                  \"Price\": p_price,\r\n                  \"Quantity\": p_quantity,\r\n                  \"Cart_Amount\": Purchase_Amount,\r\n                  \"Purchase_Amount\": Purchase_Amount,\r\n                  \"Order_Address_City\": Order_Address_City,\r\n                  \"Order_Address_Pin\": Order_Address_Pin,\r\n                  \"Coupon_Code_Applied\": Coupon_Code_Applied,\r\n                  \"Coupon_Code_Applied_Name\": Coupon_Code_Applied_Name,\r\n                  \"Coupon_Code_Applied_Amount\": Coupon_Code_Applied_Amount\r\n\r\n                });\r\n      });\r\n     \r\n     \r\n  });\r\n  let MADid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\r\n      const r = Math.random() * 16 | 0;\r\n      const v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n      return v.toString(16);\r\n    });\r\n    let u_id = $(\".customer_id\").val();\r\n    var platform = '';\r\n    if (screen.width < 1024) {\r\n      platform = 'mobile';\r\n    } else {\r\n      platform = 'desktop';\r\n    }\r\n    axios.get('https://bg-sync-api-dev.kapiva.in/api/vueDataHomePage.php', {\r\n        params: {\r\n          mad_uuid: MADid,\r\n          user_id: u_id,\r\n          page_name: 'OC',\r\n          platform: platform,\r\n          product: ''\r\n        },\r\n        async: false,\r\n      })\r\n      .then(function (response) {\r\n        var len=response.data.data.length;\r\n        \r\n        var sectionValue = [\"browsing_history\"];\r\n        var sectionKey = [\"Inspired By Your Browsing History-1\"]\r\n        var objSection = {};\r\n        for (var i = 0; i < 4; i++) {\r\n          objSection[sectionKey[i]] = sectionValue[i];\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          var htmlData = response.data.data[i].data;\r\n        \r\n          var html = '';\r\n\r\n          html += '<ul class=\"productCarousel owl-carousel owl-theme\">'\r\n          var variant_sku = '';\r\n\r\n          htmlData.forEach(function (value, index) {\r\n            if(index < 9){\r\n            var discount_price = value.price - value.discounted_price;\r\n            var discount = (discount_price * 100) / value.price;\r\n            var discount_round = discount.toPrecision(2);\r\n            var total = discount_round + \"% OFF\";\r\n            html += '<li class=\"productCarousel-slide\" data-position=\"0\">'\r\n            html += '<article class=\"card\" data-product-id=\"undefined\">'\r\n            html += '<figure class=\"card-figure\">'\r\n            html += '<a href=\"' + value.link +\r\n              '\" class=\"card-figure__link kapiva-curve small overflow-hidden\">'\r\n            html += '<div class=\"card-img-container\"><img src=\"' + value.image_link + '\" data-src=\"' + value\r\n              .image_link + '\" data-sizes=\"auto\" alt=\"' + value.title + '\" title=\"' + value.title +\r\n              '\" class=\"card-image kapiva-curve big loaded shown lazyautosizes ls-is-cached lazyloaded\" sizes=\"426px\"></div>'\r\n            html += '<div class=\"tag-section\">'\r\n            html += '<span class=\"groupBox\">'\r\n            html += '<span class=\"saleSavingTag\">' + total + '</span>'\r\n            html += '</span>'\r\n            html += '</div>'\r\n            html += '</a>'\r\n            html += '</figure>'\r\n            html += '<div class=\"card-body\">'\r\n            html += '<h3 class=\"card-title\"><a href=\"' + value.link + '\">' + value.title + '</a></h3>'\r\n            html += '<div class=\"card-text\" data-test-info-type=\"price\">'\r\n            html +=\r\n              '<div class=\"price-section price-section--withoutTax rrp-price--withoutTax\"><span data-page-builder-key=\"pdp-retail-price-label\" data-default-translation=\"MSRP:\"></span><span data-product-rrp-price-without-tax=\"\" class=\"price price--rrp\">₹' +\r\n              value.price + '</span></div>'\r\n            html +=\r\n              '<div class=\"price-section price-section--withoutTax non-sale-price--withoutTax\"><span data-page-builder-key=\"pdp-non-sale-price-label\" data-default-translation=\"Was:\"></span><span data-product-non-sale-price-without-tax=\"\" class=\"price price--non-sale\">₹' +\r\n              value.price + '</span></div>'\r\n            html +=\r\n              '<div class=\"price-section price-section--withoutTax\"><span class=\"price-label\" style=\"display: none;\"></span><span class=\"price-now-label\" data-page-builder-key=\"pdp-sale-price-label\" data-default-translation=\"Now:\"></span><span data-product-price-without-tax=\"\" class=\"price price--withoutTax price--actual\">₹' +\r\n              value.discounted_price + '</span></div>'\r\n            html += '</div>'\r\n            html += '<div class=\"Prod-AddToCart\" data-vue-analytics-click-event=\"set\">'\r\n            html +=\r\n              '<a href=\"javascript:void(0);\" data-event-type=\"product-click\" data-button-type=\"add-cart\" class=\"button button--small buy-now tranding_buy_now_add_to_cart\" data-product-id=\"' +\r\n              value.pid + '\">Buy Now</a>'\r\n            html += '<div class=\"ProductAddtocartWrap Prod-AddToCart-add cardwishlist add-cart\">'\r\n            html += '<div class=\"form ProductWhislist\" data-wishlist-add=\"\">'\r\n            html += '<div class=\"button button-wishlist\">'\r\n            html += '<span class=\"heart-icon\">'\r\n            html +=\r\n              '<a href=\"javascript:void(0);\" data-event-type=\"product-click\" data-button-type=\"add-cart\" id=\"trand-card-addtocart-button\" class=\"bag-icon trand-card-addtocart-button tranding_' +\r\n              value.pid + '\" data-product-id=\"' + value.pid +\r\n              '\"> <svg id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 380 367\" width=\"38\" height=\"38\"><path class=\"\" d=\"M332.66,104.44C330.5,90.93,320,81.85,306.48,81.85H104.77l-.06-.72L103.5,68.76c-.24-2.35-.46-4.69-.68-7-.59-6.14-1.19-12.48-2-18.74-1-8-7.27-13.81-14.87-13.89C75,29,65,29,55.15,29.09c-7.73.1-14.15,6.45-14.94,14.77a17.23,17.23,0,0,0,4.14,13.27,15.64,15.64,0,0,0,11.49,5.18c4.74.08,9.36.06,14.25,0h.75l.36,3.58c.66,6.61,1.3,13.08,1.93,19.55l3.3,34.29q1.72,17.92,3.46,35.85,1.14,11.73,2.3,23.44c1.57,15.87,3.2,32.29,4.65,48.43,1.9,21.07,16.94,35.79,36.58,35.79H273.75c17.59,0,31.85-12.3,35.5-30.59,8.18-41.06,15.72-79.24,23-116.72A34.09,34.09,0,0,0,332.66,104.44ZM127,229.77c-2.82,0-4.32-.73-4.71-4.68q-2.3-22.82-4.49-45.65l-6.25-63.94c31.93,0,62.72.24,92.55.45,29.68.21,60.3.42,92.09.45-3.64,18.38-7.53,36.85-11.29,54.71-3.72,17.64-7.56,35.87-11.17,54-.87,4.39-2.26,4.61-4.65,4.61C219,229.79,177.13,229.79,127,229.77Z\"></path><path class=\"\" d=\"M262.44,274.84a28.24,28.24,0,0,0-20.3,7.85A29.85,29.85,0,0,0,232.7,304c-.19,16,12.85,29.19,29.06,29.48h.52c15.67,0,28.61-12.8,29-28.78C291.62,288.45,279,275.33,262.44,274.84Z\"></path><path class=\"\" d=\"M140.7,274.84h-.24a29.34,29.34,0,0,0,0,58.67h.21A28.89,28.89,0,0,0,161,325.14a29.24,29.24,0,0,0,.18-41.76A28.77,28.77,0,0,0,140.7,274.84Z\"></path></svg><div id=\"pro-count\"></div>'\r\n            html += '</a>'\r\n            html += '</span>'\r\n            html += '</div>'\r\n            html += '</div>'\r\n            html += '</div>'\r\n            html += '</div>'\r\n            html += '</div>'\r\n            html += '</article>'\r\n            html += '</li>'\r\n            }\r\n          });\r\n          html += '</ul>'\r\n          if (htmlData.length > 0 && objSection[response.data.data[i].module_name]) {\r\n            document.querySelectorAll('.CatSlider-Wrap.' + objSection[response.data.data[i].module_name])[0].style\r\n              .display = 'block';\r\n            var new_section = document.querySelectorAll('.product-space.' + objSection[response.data.data[i]\r\n              .module_name]);\r\n            new_section[0].innerHTML = html;\r\n\r\n            $('.product-space.' + objSection[response.data.data[i].module_name] + ' .owl-carousel').owlCarousel({\r\n              items: 3,\r\n              loop: true,\r\n              responsiveClass: true,\r\n              responsive: {\r\n                0: {\r\n                  items: 1\r\n                },\r\n                550: {\r\n                  items: 2\r\n                },\r\n                960: {\r\n                  items: 3\r\n                }\r\n              }\r\n            });\r\n          } else if (objSection[response.data.data[i].module_name]) {\r\n            document.querySelectorAll('.CatSlider-Wrap.' + objSection[response.data.data[i].module_name])[0].style\r\n              .display = 'none';\r\n          }\r\n        }\r\n\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      })\r\n      .then(function () {\r\n        // always executed\r\n      });\r\n      CountAddToCart()\r\n    function CountAddToCart() {\r\n      var setinterval = setInterval(function () {\r\n        var len = document.getElementsByClassName(\"bag-icon\").length;\r\n        if (len > 0) {\r\n          clearInterval(setinterval);\r\n          fetch('/api/storefront/carts?include=', {\r\n            'credentials': 'include',\r\n            'headers': {\r\n              'Accept': 'application/json',\r\n              'Content-Type': 'application/json'\r\n            }\r\n          }).then(function (response) {\r\n            response.json().then(function (data) {\r\n              if (data.length != 0) {\r\n                var getid = data[0]['lineItems']['physicalItems'];\r\n\r\n                getid.forEach(function (value, key) {\r\n                  var pid = value.productId;\r\n\r\n                  var qty = value.quantity;\r\n                  var bagIcon = document.getElementsByClassName(\"bag-icon\");\r\n                  document.querySelectorAll('.bag-icon').forEach(item => {\r\n                    //  bagIcon.forEach(function (value,key) {\r\n\r\n                    var p_id = item.getAttribute(\"data-product-id\");\r\n                    if (p_id != undefined && p_id == pid && qty != null) {\r\n                      let el = item;\r\n                      $(this).find(\"#pro-count\").text(qty);\r\n\r\n                      item.parentElement.querySelectorAll('#pro-count')[0].textContent = qty;\r\n                      item.parentElement.parentElement.parentElement.parentElement.classList.add(\"fill-Prod-add-to-cart\");\r\n                      item.parentElement.querySelectorAll('#pro-count')[0].classList.add(\"fill-count\");\r\n                    }\r\n\r\n                  })\r\n                })\r\n              }\r\n            })\r\n          })\r\n        }\r\n      }, 200)\r\n    }\r\n  var interval = setInterval(function () {\r\n         var len3 = document.querySelectorAll(\".browsing_history .productCarousel\").length; \r\n     \r\n         //var len3 = document.querySelectorAll(\".Prod-AddToCart .buy-now.tranding_buy_now_add_to_cart\").length;\r\n       \r\n         if (len3 > 0) {\r\n        \r\n          clearInterval(interval);\r\n          //buynow trending products\r\n          document.querySelectorAll('.Prod-AddToCart .buy-now.tranding_buy_now_add_to_cart').forEach(item => {\r\n            item.addEventListener('click', function (event) {\r\n               event.preventDefault();\r\n            \r\n               var discount_pr = '';\r\n               \r\n               if(this.parentElement.parentElement.parentElement.querySelectorAll(\".card-figure .card-figure__link .tag-section .groupBox .saleSavingTag\").length > 0){\r\n              var discount = this.parentElement.parentElement.parentElement.querySelectorAll(\".card-figure .card-figure__link .tag-section .groupBox .saleSavingTag\")[0].textContent;\r\n               discount_pr = discount.trim();\r\n               }\r\n              var pro_id = this.getAttribute(\"data-product-id\");\r\n              if (this.classList.contains('disabled') == false) {\r\n                var cart_quantity = localStorage.getItem('cart-quantity');\r\n               \r\n\r\n                axios({\r\n                  url: '/remote/v1/cart/add',\r\n                  method: 'post',\r\n                  dataType: 'json',\r\n                  data: {\r\n                    action: 'add',\r\n                    \"product_id\": pro_id,\r\n                    \"qty[]\": 1\r\n                  }\r\n                }).then((result) => {\r\n                  if (result.data.data.cart_item) {\r\n                    buyNow(pro_id, discount_pr)\r\n                    window.location.href = '/checkout';\r\n                  }\r\n                });\r\n              }\r\n            });\r\n          });\r\n          //end buynow trending products\r\n\r\n          //addtocart trending product\r\n          document.querySelectorAll('#trand-card-addtocart-button').forEach(item => {\r\n            item.addEventListener('click', function (value, index) {\r\n\r\n              value.preventDefault();\r\n              var pro_id = this.getAttribute(\"data-product-id\");\r\n              var discount = this.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.querySelectorAll(\".card-figure .card-figure__link .tag-section .groupBox .saleSavingTag\")[0].textContent;\r\n              let discount_pr = discount.trim();\r\n              var cart_quantity = localStorage.getItem('cart-quantity');\r\n\r\n              axios({\r\n                url: '/remote/v1/cart/add',\r\n                method: 'post',\r\n                dataType: 'json',\r\n                data: {\r\n                  action: 'add',\r\n                  \"product_id\": pro_id,\r\n                  \"qty[]\": 1\r\n                }\r\n              }).then((result) => {\r\n                if (result.data.data.cart_item) {\r\n                 \r\n                }\r\n                fetch('/api/storefront/carts?include=', {\r\n                  'credentials': 'include',\r\n                  'headers': {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json'\r\n                  }\r\n                }).then(function (response) {\r\n                  response.json().then(function (data) {\r\n                    if (data.length != 0) {\r\n                      var getid = data[0]['lineItems']['physicalItems'];\r\n                      getid.forEach(function (value, key) {\r\n                        var pid = value.productId;\r\n\r\n                        var qty = value.quantity;\r\n\r\n                        if (pro_id != undefined && pro_id == pid) {\r\n                          let tranding = document.getElementsByClassName(\"tranding_\" + pid)[0];\r\n                          tranding.parentElement.querySelectorAll('#pro-count')[0].textContent = qty;\r\n                          tranding.parentElement.parentElement.parentElement.parentElement.classList.add(\"fill-Prod-add-to-cart\");\r\n                          tranding.parentElement.querySelectorAll('#pro-count')[0].classList.add(\"fill-count\");\r\n                          \r\n                        }\r\n                       \r\n                      });\r\n                      addToCart(pro_id, discount_pr)\r\n                    }\r\n                  });\r\n                });\r\n               \r\n              });\r\n            });\r\n          });\r\n          //end addtocart trending product\r\n        }\r\n      }, 1000);\r\n      function addToCart(pro_id, discount_pr) {\r\n    \r\n    var p_id = '';\r\n    var p_name = '';\r\n    var mrp = '';\r\n    var discounted_price = '';\r\n    var Quantity = '';\r\n    var total_item_in_cart = '';\r\n    var cart_value = '';\r\n\r\n   \r\n      fetch('/api/storefront/carts?productId=' + pro_id, {\r\n        'credentials': 'include',\r\n        'headers': {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json'\r\n        }\r\n      }).then(function (response) {\r\n        response.json().then(function (data) {\r\n          if (data) {\r\n            cart_value = data[0].cartAmount;\r\n            var getquantity = data[0]['lineItems']['physicalItems'];\r\n            getquantity.forEach(function (value, key) {\r\n              if (value.productId == pro_id) {\r\n                Quantity = value.quantity;\r\n              }\r\n              if (total_item_in_cart == '') {\r\n                total_item_in_cart = value.quantity;\r\n              } else {\r\n                total_item_in_cart = total_item_in_cart + value.quantity;\r\n              }\r\n\r\n            })\r\n          }\r\n\r\n\r\n\r\n          var query = `query productById{\r\n                       site {\r\n                         product(entityId: ` + pro_id + `) {\r\n                           id\r\n                           entityId\r\n                           name\r\n                           categories\r\n                           {\r\n                           edges\r\n                             {\r\n                               node\r\n                               {\r\n                                 id\r\n                                 name\r\n                                 \r\n                               }\r\n                             } \r\n                           }\r\n                           prices (includeTax:true){\r\n                             price {\r\n                               ...MoneyFields\r\n                             }\r\n                             \r\n                             salePrice {\r\n                               ...MoneyFields\r\n                             }\r\n                             retailPrice {\r\n                               ...MoneyFields\r\n                             }\r\n                            \r\n                           }\r\n                         }\r\n                       }\r\n                     }\r\n   \r\n                     fragment MoneyFields on Money {\r\n                       value\r\n                       currencyCode\r\n                     }`;\r\n          axios({\r\n            url: '/graphql',\r\n            method: 'post',\r\n            contentType: \"application/json\",\r\n            headers: {\r\n              'Authorization': 'Bearer {{ settings.storefront_api.token }}'\r\n            },\r\n            data: {\r\n              query: query\r\n            }\r\n          }).then((result) => {\r\n            var alldata = result.data.data.site.product;\r\n\r\n            if (alldata != null) {\r\n              p_id = alldata.entityId;\r\n\r\n              p_name = alldata.name;\r\n              if (alldata.prices.retailPrice != null) {\r\n                mrp = alldata.prices.retailPrice.value;\r\n              }\r\n              if (alldata.prices.salePrice != null) {\r\n                discounted_price = alldata.prices.salePrice.value;\r\n              } else {\r\n                discounted_price = 0;\r\n              }\r\n\r\n              var category = alldata.categories.edges;\r\n              var category_ID = [];\r\n              var category_NAME = [];\r\n              category.forEach(function (value, index) {\r\n                category_ID.push(value.node.id);\r\n                category_NAME.push(value.node.name);\r\n\r\n              })\r\n              var categories = {\r\n                category_ID,\r\n                category_NAME\r\n              };\r\n              var category_id = '';\r\n              var category_name = '';\r\n              category.forEach(function (value, index) {\r\n                if (category_id == '' && category_name == '') {\r\n                  var cat_id = value.node.id;\r\n                  var splited_url = atob(cat_id);\r\n                  var categoryid = splited_url.split(\"Category:\");\r\n                  category_id = categoryid[1];\r\n                  category_name = value.node.name\r\n                } else {\r\n                  var splited_url = atob(value.node.id);\r\n                  var categoryid = splited_url.split(\"Category:\");\r\n                  var catid = categoryid[1];\r\n                  category_id = category_id + ',' + catid;\r\n                  category_name = category_name + ',' + value.node.name;\r\n                }\r\n\r\n              })\r\n\r\n              webengage.track(\"add to cart\", {\r\n                  \"Product_ID\": p_id,\r\n                  \"Product_Name\": p_name,\r\n                  \"Category_ID\": category_id,\r\n                  \"Category_Name\": category_name,\r\n                  \"MRP\": mrp,\r\n                  \"Discount\": discount_pr,\r\n                  \"Discount_Price\": discounted_price,\r\n                  \"Quantity\": Quantity,\r\n                  \"Total_Item_in_cart\": total_item_in_cart,\r\n                  \"Cart_value\": cart_value\r\n              });\r\n              var productObject = {\r\n                \"Product_ID\": p_id,\r\n                \"Product_Name\": p_name,\r\n                \"categories\": categories,\r\n                \"price\": mrp,\r\n                \"salePrice\": discounted_price,\r\n                \"Quantity\": Quantity\r\n              };\r\n\r\n              dataLayer.push({\r\n                ecommerce: null\r\n              }); // Clear the previous ecommerce object.\r\n              dataLayer.push({\r\n                'event': 'addToCart',\r\n                'ecommerce': {\r\n                  'currencyCode': 'INR',\r\n                  'add': { // 'add' actionFieldObject measures.\r\n                    'products': [{ //  adding a product to a shopping cart.\r\n                      'name': p_name,\r\n                      'id': p_id,\r\n                      'price': discounted_price,\r\n                      'brand': 'Kapiva',\r\n                      'quantity': Quantity\r\n                    }]\r\n                  }\r\n                }\r\n              });\r\n              window.dataLayer = window.dataLayer || [];\r\n              window.dataLayer.push({\r\n                addToCartProduct: productObject\r\n              });\r\n\r\n               fbq('track', 'AddToCart', {\r\n               content_ids: p_id,\r\n               content_type: 'product',\r\n               value: discounted_price,\r\n               currency: 'INR',\r\n                quantity: Quantity\r\n              });\r\n\r\n            }\r\n          });\r\n        });\r\n      });\r\n    \r\n  }\r\n  function buyNow(pro_id, discount_pr) {\r\n          var p_id = '';\r\n          var p_name = '';\r\n          var mrp = '';\r\n          var discounted_price = '';\r\n          var Quantity = '';\r\n          var total_item_in_cart = '';\r\n          var cart_value = '';\r\n         \r\n            fetch('/api/storefront/carts?productId=' + pro_id, {\r\n              'credentials': 'include',\r\n              'headers': {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n              }\r\n            }).then(function (response) {\r\n              response.json().then(function (data) {\r\n                if (data) {\r\n    \r\n                  cart_value = data[0].cartAmount;\r\n                  var getquantity = data[0]['lineItems']['physicalItems'];\r\n                  getquantity.forEach(function (value, index) {\r\n                    if (value.productId == pro_id) {\r\n                      Quantity = value.quantity;\r\n                    }\r\n                    if (total_item_in_cart == '') {\r\n                      total_item_in_cart = value.quantity;\r\n                    } else {\r\n                      total_item_in_cart = total_item_in_cart + value.quantity;\r\n                    }\r\n    \r\n                  })\r\n                }\r\n                var query = `query productById{\r\n                        site {\r\n                          product(entityId: ` + pro_id + `) {\r\n                            id\r\n                            entityId\r\n                            name\r\n                            categories\r\n                            {\r\n                            edges\r\n                              {\r\n                                node\r\n                                {\r\n                                  id\r\n                                  name\r\n                                  \r\n                                }\r\n                              } \r\n                            }\r\n                            prices (includeTax:true){\r\n                              price {\r\n                                ...MoneyFields\r\n                              }\r\n                              salePrice {\r\n                                ...MoneyFields\r\n                              }\r\n                              retailPrice {\r\n                                ...MoneyFields\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n    \r\n                      fragment MoneyFields on Money {\r\n                        value\r\n                        currencyCode\r\n                      }`;\r\n                axios({\r\n                  url: '/graphql',\r\n                  method: 'post',\r\n                  contentType: \"application/json\",\r\n                  headers: {\r\n                    'Authorization': 'Bearer {{ settings.storefront_api.token }}'\r\n                  },\r\n                  data: {\r\n                    query: query\r\n                  }\r\n                }).then((result) => {\r\n                  var alldata = result.data.data.site.product;\r\n                  if (alldata != null) {\r\n                    p_id = alldata.entityId;\r\n    \r\n                    p_name = alldata.name;\r\n                    if (alldata.prices.retailPrice != null) {\r\n                      mrp = alldata.prices.retailPrice.value;\r\n                    }\r\n                    if (alldata.prices.salePrice != null) {\r\n                      discounted_price = alldata.prices.salePrice.value;\r\n                    } else {\r\n                      discounted_price = 0;\r\n                    }\r\n    \r\n                    var category = alldata.categories.edges;\r\n                    var category_ID = [];\r\n                    var category_NAME = [];\r\n                    category.forEach(function (value, index) {\r\n    \r\n                      category_ID.push(value.node.id);\r\n                      category_NAME.push(value.node.name);\r\n    \r\n                    })\r\n                    var categories = {\r\n                      category_ID,\r\n                      category_NAME\r\n                    };\r\n                    var category_id = '';\r\n                    var category_name = '';\r\n                    category.forEach(function (value, index) {\r\n                      if (category_id == '' && category_name == '') {\r\n                        var cat_id = value.node.id;\r\n                        var splited_url = atob(cat_id);\r\n                        var categoryid = splited_url.split(\"Category:\");\r\n                        category_id = categoryid[1];\r\n                        category_name = value.node.name\r\n                      } else {\r\n                        var splited_url = atob(value.node.id);\r\n                        var categoryid = splited_url.split(\"Category:\");\r\n                        var catid = categoryid[1];\r\n                        category_id = category_id + ',' + catid;\r\n                        category_name = category_name + ',' + value.node.name;\r\n                      }\r\n    \r\n                    })\r\n                   \r\n                    webengage.track(\"buy now\", {\r\n                      \"Product_ID\": p_id,\r\n                      \"Product_Name\": p_name,\r\n                      \"Category_ID\": category_id,\r\n                      \"Category_Name\": category_name,\r\n                      \"MRP\": mrp,\r\n                      \"Discount\": discount_pr,\r\n                      \"Discount_Price\": discounted_price,\r\n                      \"Quantity\": Quantity,\r\n                      \"Total_Item_in_cart\": total_item_in_cart,\r\n                      \"Cart_value\": cart_value\r\n                    });\r\n                  \r\n                    var productObject = {\r\n                      \"Product_ID\": p_id,\r\n                      \"Product_Name\": p_name,\r\n                      \"categories\": categories,\r\n                      \"price\": mrp,\r\n                      \"salePrice\": discounted_price,\r\n                      \"Quantity\": Quantity\r\n                    };\r\n    \r\n                    dataLayer.push({\r\n                      ecommerce: null\r\n                    }); // Clear the previous ecommerce object.\r\n                    dataLayer.push({\r\n                      'event': 'buyNow',\r\n                      'ecommerce': {\r\n                        'currencyCode': 'INR',\r\n                        'add': { // 'add' actionFieldObject measures.\r\n                          'products': [{ //  adding a product to a shopping cart.\r\n                            'name': p_name,\r\n                            'id': p_id,\r\n                            'price': discounted_price,\r\n                            'brand': 'Kapiva',\r\n                            'quantity': Quantity\r\n                          }]\r\n                        }\r\n                      }\r\n                    });\r\n                    window.dataLayer = window.dataLayer || [];\r\n                    window.dataLayer.push({\r\n                      buyNowProduct: productObject\r\n                    });\r\n                    fbq('track', 'buyNow', {\r\n                      content_ids: p_id,\r\n                      content_type: 'product',\r\n                      value: discounted_price,\r\n                      currency: 'INR',\r\n                      quantity: Quantity\r\n                    });\r\n                    window.location.href = '/checkout';\r\n                  }\r\n                });\r\n              });\r\n            });\r\n        \r\n        }\r\n</script>\r\n"}
